#let(table = [
    "title": "Menus",
    "key": "frontend.menus",
    "field": [
        "key": "name"
    ]
])

#var(columns = "1fr")
#var(actions = 0)
#if(UserHasPermission("frontend.menu.items.list")):
    #(columns += " 64px")
    #(actions += 1)
#endif
#if((table.edit ?? true) && UserHasPermission(table.key + ".update")):
    #(columns += " 64px")
    #(actions += 1)
#endif
#if((table.delete ?? true) && UserHasPermission(table.key + ".delete")):
    #(columns += " 64px")
    #(actions += 1)
#endif


#define(css):
tr {
    grid-template-columns: repeat(#max(1, actions), 1fr);
}
@media (min-width: 600px) {
    tr {
        grid-template-columns: #(columns);
    }
}
#enddefine

#define(th):
    <th class="margin-horizontal-xs compact-center#if(actions > 0): compact-col#(actions)#endif">
        #let(link = [
             "key": table.field.key,
             "default": true,
             "sort": (table.field.sort ?? "asc")
        ])
        #inline("Admin/SortLink")
    </th>

    #if(UserHasPermission("frontend.menu.items.list")):
    <th class="text-align-center compact-hidden">Items</th>
    #endif

    #if((table.edit ?? true) && UserHasPermission(table.key + ".update")):
    <th class="text-align-center compact-hidden">Edit</th>
    #endif
    
    #if((table.delete ?? true) && UserHasPermission(table.key + ".delete")):
    <th class="text-align-center compact-hidden">Delete</th>
    #endif

#enddefine

#define(tr):
    #for(item in list.items):
    <tr>
        <td class="margin-horizontal-xs compact-margin compact-center#if(actions > 0): compact-separator compact-col#(actions)#endif">
            #if((table.view ?? true) && UserHasPermission(table.key + ".get")):
            <a href="#($req.url.path)#(item.id)/">#(item[table.field.key])</a>
            #else:
            #(item[table.field.key])
            #endif
        </td>

        #if(UserHasPermission("frontend.menu.items.list")):
        <td class="text-align-center">
            <a href="#($req.url.path)#(item.id)/items/">#svg("link")</a>
        </td>
        #endif
        
        #if((table.edit ?? true) && UserHasPermission(table.key + ".update")):
        <td class="text-align-center">
            <a href="#($req.url.path)#(item.id)/update">#svg("edit-2")</a>
        </td>
        #endif

        #if((table.delete ?? true) && UserHasPermission(table.key + ".delete")):
        <td class="text-align-center">
            <a href="#($req.url.path)#(item.id)/delete/">#svg("trash")</a>
        </td>
        #endif
    </tr>
    #endfor
#enddefine

#inline("Admin/BaseTable")
